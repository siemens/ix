/*
 * SPDX-FileCopyrightText: 2026 Siemens AG
 *
 * SPDX-License-Identifier: MIT
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
import { resolveTestIds } from './utils';
import { excludedTestIds } from '../tests/exclude-test-ids';
import path from 'node:path';
import fs from 'fs/promises';

const __dirname = path.dirname(new URL(import.meta.url).pathname);

async function main() {
  let testIds = await resolveTestIds();
  testIds = testIds.filter((id) => !excludedTestIds.includes(id));

  const rawTestIdsArray = `export const testIds = ${JSON.stringify(
    testIds,
    null,
    2
  )} as const;`;

  await fs.writeFile(
    path.join(__dirname, '..', 'tests', 'test-ids.autogenerated.ts'),
    rawTestIdsArray,
    'utf-8'
  );
}

main().catch((err) => {
  console.error('Error in main execution:', err);
  process.exit(1);
});
