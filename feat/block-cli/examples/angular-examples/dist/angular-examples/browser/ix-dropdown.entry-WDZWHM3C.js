import{b as C}from"./chunk-EOOEFSGA.js";import{a as f,b as v,c as b,d as y,g as E,h as x}from"./chunk-6HB2AEXZ.js";import{a as k}from"./chunk-4HTR3B65.js";import{a as u}from"./chunk-SJ4KFJMT.js";import{a as c,b as r}from"./chunk-6XX5KG6K.js";import{a as l}from"./chunk-NDRGZPEH.js";import{a as w}from"./chunk-J7K75NWW.js";import{a as S,d as s,e as m,f as D,g as I}from"./chunk-M63OK7P4.js";import{f as o}from"./chunk-IXF2NW34.js";var L=":host{background-color:var(--theme-color-2);border-radius:var(--theme-default-border-radius);min-width:0px;z-index:var(--theme-z-index-dropdown);box-shadow:var(--theme-shadow-4);padding:0.25rem 0px}:host *,:host *::after,:host *::before{box-sizing:border-box}:host ::-webkit-scrollbar-button{display:none}@-moz-document url-prefix(){:host *{scrollbar-color:var(--theme-scrollbar-thumb--background) var(--theme-scrollbar-track--background);scrollbar-width:thin}}:host{}:host ::-webkit-scrollbar{width:0.5rem;height:0.5rem}:host{}:host ::-webkit-scrollbar-track{border-radius:5px;background:var(--theme-scrollbar-track--background)}:host ::-webkit-scrollbar-track:hover{background:var(--theme-scrollbar-track--background--hover)}:host{}:host ::-webkit-scrollbar-thumb{border-radius:5px;background:var(--theme-scrollbar-thumb--background)}:host{}:host ::-webkit-scrollbar-thumb:hover{background:var(--theme-scrollbar-thumb--background--hover)}:host ::-webkit-scrollbar-corner{display:none}:host .dropdown-header{display:flex;align-items:center;height:2.5rem;color:var(--theme-menu-header--color);padding:0 1rem}:host(.overflow){max-height:calc(50vh - 3rem);overflow-y:auto}:host(:not(.show)){display:none}.dialog{margin:0;border:none;outline:none;padding:0.25rem 0px;min-width:0;max-width:100vw;width:-moz-max-content;width:max-content;height:-moz-fit-content;height:fit-content;background-color:var(--theme-color-2);border-radius:var(--theme-default-border-radius);box-shadow:var(--theme-shadow-4);overflow-x:visible;overflow-y:visible;inset:unset;color-scheme:inherit;color:var(--theme-color-std-text);box-sizing:border-box}.dialog *,.dialog *::after,.dialog *::before{box-sizing:border-box}.dialog .dropdown-container{display:block;position:relative}.dialog .dropdown-header{display:flex;align-items:center;height:2.5rem;color:var(--theme-menu-header--color);padding:0 1rem}.dialog.overflow{max-height:calc(50vh - 3rem);overflow-y:auto}",P=0,K=(()=>{let p=class{constructor(e){S(this,e),this.showChanged=I(this,"showChanged",7),this.suppressAutomaticPlacement=!1,this.show=!1,this.closeBehavior="both",this.placement="bottom-start",this.positioningStrategy="fixed",this.discoverAllSubmenus=!1,this.ignoreRelatedSubmenu=!1,this.suppressOverflowBehavior=!1,this.enableTopLayer=!1,this.dialogRef=w(),this.localUId=`dropdown-${P++}`,this.assignedSubmenu=[],this.itemObserver=new MutationObserver(()=>{this.arrowFocusController&&(this.arrowFocusController.items=this.dropdownItems)})}connectedCallback(){r.connected(this),this.trigger!=null&&this.registerListener(this.trigger)}cacheSubmenuId(e){e.stopImmediatePropagation(),e.preventDefault();let{detail:t}=e;this.assignedSubmenu.indexOf(t)===-1&&this.assignedSubmenu.push(t)}disconnectedCallback(){var e;r.dismiss(this),r.disconnected(this),this.arrowFocusController&&((e=this.arrowFocusController)===null||e===void 0||e.disconnect(),this.arrowFocusController=void 0),this.itemObserver&&(this.itemObserver.disconnect(),this.itemObserver=void 0),this.disposeClickListener&&(this.disposeClickListener(),this.disposeClickListener=void 0),this.disposeKeyListener&&(this.disposeKeyListener(),this.disposeKeyListener=void 0),this.autoUpdateCleanup&&(this.autoUpdateCleanup(),this.autoUpdateCleanup=void 0)}getAssignedSubmenuIds(){return this.assignedSubmenu}isPresent(){return this.show}present(){this.show=!0}dismiss(){this.show=!1}getId(){return this.localUId}willDismiss(){let{defaultPrevented:e}=this.showChanged.emit(!1);return!e}willPresent(){let{defaultPrevented:e}=this.showChanged.emit(!0);return!e}get dropdownItems(){return Array.from(this.hostElement.querySelectorAll("ix-dropdown-item"))}get slotElement(){return this.hostElement.shadowRoot.querySelector("slot")}addEventListenersFor(){var e,t,i;(e=this.disposeClickListener)===null||e===void 0||e.call(this),(t=this.disposeKeyListener)===null||t===void 0||t.call(this);let n=()=>{this.isPresent()?r.dismiss(this):r.present(this),r.dismissOthers(this.getId())};this.triggerElement&&(this.disposeClickListener=l(this.triggerElement,"click",a=>{a.defaultPrevented||n()}),(i=this.triggerElement)===null||i===void 0||i.setAttribute("data-ix-dropdown-trigger",this.localUId))}discoverSubmenu(){return o(this,null,function*(){var e;(e=this.triggerElement)===null||e===void 0||e.dispatchEvent(new CustomEvent("ix-assign-sub-menu",{bubbles:!0,composed:!0,cancelable:!0,detail:this.localUId}))})}registerKeyListener(){this.triggerElement&&(this.disposeKeyListener=l(this.triggerElement,"keydown",e=>{e.key==="ArrowDown"&&document.activeElement===this.triggerElement&&(r.present(this),setTimeout(()=>{this.focusDropdownItem(0)}))}))}registerListener(e){return o(this,null,function*(){this.triggerElement=yield this.resolveElement(e),this.triggerElement&&(this.addEventListenersFor(),this.discoverSubmenu())})}resolveElement(e){return o(this,null,function*(){let t=yield C(e);return this.checkForSubmenuAnchor(t)})}checkForSubmenuAnchor(e){return o(this,null,function*(){if(e){if(c(e)){let t=yield e.getDropdownItemElement();t.isSubMenu=!0,this.hostElement.style.zIndex="var(--theme-z-index-dropdown)"}return e.tagName==="IX-DROPDOWN-ITEM"&&(e.isSubMenu=!0,this.hostElement.style.zIndex="var(--theme-z-index-dropdown)"),e}})}resolveAnchorElement(){return o(this,null,function*(){this.anchor?this.anchorElement=yield this.resolveElement(this.anchor):this.trigger&&(this.anchorElement=yield this.resolveElement(this.trigger))})}changedShow(e){return o(this,null,function*(){var t;if(!e){this.cleanupOnHide(),this.enableTopLayer&&(yield this.hideDropdownAsync());return}if(this.arrowFocusController=new k(this.dropdownItems,this.hostElement,i=>this.focusDropdownItem(i)),(t=this.itemObserver)===null||t===void 0||t.observe(this.hostElement,{childList:!0,subtree:!0}),this.registerKeyListener(),this.enableTopLayer){yield this.showDropdownAsync();return}yield this.resolveAnchorElement(),this.anchorElement&&this.applyDropdownPosition()})}changedTrigger(e){this.registerListener(e)}destroyAutoUpdate(){this.autoUpdateCleanup&&(this.autoUpdateCleanup(),this.autoUpdateCleanup=void 0)}isAnchorSubmenu(){var e;return c(this.anchorElement)?!0:!!(!((e=this.anchorElement)===null||e===void 0)&&e.closest("ix-dropdown-item"))}showDropdownAsync(){return o(this,null,function*(){let e=yield this.dialogRef.waitForCurrent();e&&(e.showPopover(),yield this.resolveAnchorElement(),this.anchorElement?this.applyDropdownPosition():u(()=>{let i=(this.hostElement.parentElement||this.hostElement).getBoundingClientRect(),n=`translate(${Math.round(i.left)}px, ${Math.round(i.top)}px)`;Object.assign(e.style,{top:"0",left:"0",transform:n})}))})}hideDropdownAsync(){return o(this,null,function*(){let e=yield this.dialogRef.waitForCurrent();e?.matches(":popover-open")&&e.hidePopover()})}cleanupOnHide(){var e,t,i;this.destroyAutoUpdate(),(e=this.arrowFocusController)===null||e===void 0||e.disconnect(),(t=this.itemObserver)===null||t===void 0||t.disconnect(),(i=this.disposeKeyListener)===null||i===void 0||i.call(this)}applyDropdownPosition(){return o(this,null,function*(){var e,t;if(!this.show||!this.anchorElement)return;let i=this.anchorElement,n=this.isAnchorSubmenu(),a=this.hostElement,g=this.positioningStrategy;if(this.enableTopLayer){let d=yield this.dialogRef.waitForCurrent();if(!d)return;a=d,g="fixed"}let h={strategy:g,middleware:[]};this.suppressAutomaticPlacement||(e=h.middleware)===null||e===void 0||e.push(y({fallbackStrategy:"initialPlacement"})),h.placement=n?"right-start":this.placement,h.middleware=[...((t=h.middleware)===null||t===void 0?void 0:t.filter(Boolean))||[],E(),b()],this.offset&&h.middleware.push(v(this.offset)),this.destroyAutoUpdate(),this.autoUpdateCleanup=f(i,a,()=>o(this,null,function*(){let d=yield x(i,a,h);if(Object.assign(a.style,{top:"0",left:"0",transform:`translate(${Math.round(d.x)}px,${Math.round(d.y)}px)`}),this.overwriteDropdownStyle){let A=yield this.overwriteDropdownStyle({dropdownRef:a,triggerRef:this.triggerElement});Object.assign(a.style,A)}}),{ancestorResize:!0,ancestorScroll:!0,elementResize:!0})})}focusDropdownItem(e){u(()=>{var t,i;let n=(i=(t=this.dropdownItems[e])===null||t===void 0?void 0:t.shadowRoot)===null||i===void 0?void 0:i.querySelector("button");n&&n.focus()})}componentDidLoad(){return o(this,null,function*(){this.show&&this.changedShow(!0),this.trigger&&this.changedTrigger(this.trigger)})}componentDidRender(){return o(this,null,function*(){yield this.applyDropdownPosition(),yield this.resolveAnchorElement()})}isTriggerElement(e){return!!e.hasAttribute("data-ix-dropdown-trigger")}onDropdownClick(e){let t=r.pathIncludesTrigger(e.composedPath());if(t&&(t!==this.triggerElement&&e.preventDefault(),this.isTriggerElement(t))){this.closeBehavior==="outside"&&e.preventDefault();return}if(!e.defaultPrevented&&(this.closeBehavior==="inside"||this.closeBehavior==="both")){r.dismissAll([this.getId()],this.ignoreRelatedSubmenu);return}r.dismissOthers(this.getId())}updatePosition(){return o(this,null,function*(){this.applyDropdownPosition()})}render(){return this.enableTopLayer?s(m,{"data-ix-dropdown":this.localUId,class:{"dropdown-menu":!0,show:this.show}},s("dialog",{ref:this.dialogRef,class:{dialog:!0,overflow:!this.suppressOverflowBehavior},popover:"manual","aria-modal":"true","aria-label":this.header,tabindex:-1,onClick:e=>this.onDropdownClick(e)},s("div",{class:"dropdown-container"},this.header&&s("div",{class:"dropdown-header"},this.header),this.show&&s("slot",null)))):s(m,{"data-ix-dropdown":this.localUId,class:{"dropdown-menu":!0,show:this.show,overflow:!this.suppressOverflowBehavior},style:{margin:"0",minWidth:"0px",position:this.positioningStrategy},role:"list",onClick:e=>this.onDropdownClick(e)},s("div",{style:{display:"contents"}},this.header&&s("div",{class:"dropdown-header"},this.header),this.show&&s("slot",null)))}get hostElement(){return D(this)}static get watchers(){return{show:["changedShow"],trigger:["changedTrigger"]}}};return p.style=L,p})();export{K as ix_dropdown};
//# sourceMappingURL=ix-dropdown.entry-WDZWHM3C.js.map
