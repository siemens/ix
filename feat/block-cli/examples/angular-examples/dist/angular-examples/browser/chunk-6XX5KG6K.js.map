{"version":3,"sources":["node_modules/@siemens/ix/dist/esm/dropdown-controller-D3K9vmFp.js"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2024 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nfunction hasDropdownItemWrapperImplemented(item) {\n  return item !== null && item.getDropdownItemElement !== undefined && typeof item.getDropdownItemElement === 'function';\n}\nclass DropdownController {\n  constructor() {\n    this.dropdowns = new Map();\n    this.submenuIds = {};\n    this.isWindowListenerActive = false;\n  }\n  connected(dropdown) {\n    if (!this.isWindowListenerActive) {\n      this.addOverlayListeners();\n    }\n    this.dropdowns.set(dropdown.getId(), dropdown);\n    if (dropdown.discoverAllSubmenus) {\n      this.discoverSubmenus();\n    }\n  }\n  disconnected(dropdown) {\n    const id = dropdown.getId();\n    this.removeFromSubmenuIds(id);\n    this.dropdowns.delete(id);\n  }\n  removeFromSubmenuIds(id) {\n    this.dropdowns.forEach(dropdown => {\n      const submenuIds = this.submenuIds[dropdown.getId()];\n      if (submenuIds) {\n        const index = submenuIds.indexOf(id);\n        if (index > -1) {\n          submenuIds.splice(index, 1);\n        }\n      }\n    });\n    delete this.submenuIds[id];\n  }\n  getDropdownById(id) {\n    return this.dropdowns.get(id);\n  }\n  discoverSubmenus() {\n    this.dropdowns.forEach(dropdown => {\n      dropdown.discoverSubmenu();\n    });\n  }\n  present(dropdown) {\n    var _a;\n    if (!dropdown.isPresent() && ((_a = dropdown.willPresent) === null || _a === void 0 ? void 0 : _a.call(dropdown))) {\n      this.submenuIds[dropdown.getId()] = dropdown.getAssignedSubmenuIds();\n      dropdown.present();\n    }\n  }\n  dismissChildren(uid) {\n    const childIds = this.submenuIds[uid] || [];\n    for (const id of childIds) {\n      const dropdown = this.dropdowns.get(id);\n      if (dropdown) {\n        this.dismiss(dropdown);\n      }\n    }\n  }\n  dismiss(dropdown) {\n    var _a;\n    if (dropdown.isPresent() && ((_a = dropdown.willDismiss) === null || _a === void 0 ? void 0 : _a.call(dropdown))) {\n      this.dismissChildren(dropdown.getId());\n      dropdown.dismiss();\n      delete this.submenuIds[dropdown.getId()];\n    }\n  }\n  dismissAll(ignoreBehaviorForIds = [], ignoreRelatedDropdowns = false) {\n    this.dropdowns.forEach(dropdown => {\n      const preventClosing = dropdown.closeBehavior === 'inside' || dropdown.closeBehavior === false;\n      const shouldIgnore = ignoreBehaviorForIds.includes(dropdown.getId());\n      const path = this.buildComposedPath(dropdown.getId(), new Set());\n      if (ignoreBehaviorForIds.length > 0 && ignoreRelatedDropdowns) {\n        let skipRelatedDropdown = false;\n        ignoreBehaviorForIds.forEach(id => {\n          if (path.has(id)) {\n            skipRelatedDropdown = true;\n            return;\n          }\n        });\n        if (!skipRelatedDropdown) {\n          return;\n        }\n      }\n      if (!shouldIgnore && preventClosing) {\n        return;\n      }\n      this.dismiss(dropdown);\n    });\n  }\n  dismissOthers(uid) {\n    let path = this.buildComposedPath(uid, new Set());\n    path.add(uid);\n    this.dropdowns.forEach(dropdown => {\n      if (dropdown.closeBehavior !== 'inside' && dropdown.closeBehavior !== false && !path.has(dropdown.getId())) {\n        this.dismiss(dropdown);\n      }\n    });\n  }\n  pathIncludesTrigger(eventTargets) {\n    for (let eventTarget of eventTargets) {\n      if (eventTarget instanceof HTMLElement) {\n        if (eventTarget.hasAttribute('data-ix-dropdown-trigger')) {\n          return eventTarget;\n        }\n      }\n    }\n    return;\n  }\n  pathIncludesDropdown(eventTargets) {\n    return !!eventTargets.find(element => element.tagName === 'IX-DROPDOWN');\n  }\n  buildComposedPath(id, path) {\n    if (this.submenuIds[id]) {\n      path.add(id);\n    }\n    for (const ruleKey of Object.keys(this.submenuIds)) {\n      if (this.submenuIds[ruleKey].includes(id)) {\n        this.buildComposedPath(ruleKey, path).forEach(key => path.add(key));\n      }\n    }\n    return path;\n  }\n  addOverlayListeners() {\n    this.isWindowListenerActive = true;\n    window.addEventListener('click', event => {\n      const hasTrigger = this.pathIncludesTrigger(event.composedPath());\n      const hasDropdown = this.pathIncludesDropdown(event.composedPath());\n      if (!hasTrigger && !hasDropdown) {\n        this.dismissAll();\n      }\n    });\n    window.addEventListener('keydown', event => {\n      if (event.key === 'Escape') {\n        this.dismissAll([...this.dropdowns.keys()]);\n      }\n    });\n  }\n}\nconst dropdownController = new DropdownController();\nexport { dropdownController as d, hasDropdownItemWrapperImplemented as h };\n\n\n"],"mappings":"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","names":["hasDropdownItemWrapperImplemented","item","DropdownController","dropdown","id","submenuIds","index","_a","uid","childIds","ignoreBehaviorForIds","ignoreRelatedDropdowns","preventClosing","shouldIgnore","path","skipRelatedDropdown","eventTargets","eventTarget","element","ruleKey","key","event","hasTrigger","hasDropdown","dropdownController"],"x_google_ignoreList":[0]}